2024-06-13 13:16:37 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:16:37 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:16:39 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:16:39 | ERROR | stderr | 
2024-06-13 13:16:39 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:16:39 | ERROR | stderr |   warnings.warn(
2024-06-13 13:16:39 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m191463[0m]
2024-06-13 13:16:39 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:16:39 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:16:39 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:16:41 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:16:41 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:16:41 | INFO | stdout | [32mINFO[0m:     192.168.110.131:38880 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:16:41 | ERROR | stderr | Process openai_api:
2024-06-13 13:16:41 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:16:41 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:16:41 | ERROR | stderr |     self.run()
2024-06-13 13:16:41 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:16:41 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:16:41 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 171, in run_openai_api
2024-06-13 13:16:41 | ERROR | stderr |     app = create_openai_api_app(controller_addr, log_level=log_level)
2024-06-13 13:16:41 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:16:41 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 189, in create_openai_api_app
2024-06-13 13:16:41 | ERROR | stderr |     from fastchat.serve.openai_api_server import app, CORSMiddleware, app_settings
2024-06-13 13:16:41 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/fastchat/serve/openai_api_server.py", line 39, in <module>
2024-06-13 13:16:41 | ERROR | stderr |     from fastchat.protocol.openai_api_protocol import (
2024-06-13 13:16:41 | ERROR | stderr | ModuleNotFoundError: No module named 'fastchat.protocol'
2024-06-13 13:16:42 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:16:42 | ERROR | stderr | 
2024-06-13 13:16:42 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:16:42 | ERROR | stderr |   warnings.warn(
2024-06-13 13:16:42 | ERROR | stderr | Process API Server:
2024-06-13 13:16:42 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:16:42 | ERROR | stderr |     self.run()
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:16:42 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:16:42 | ERROR | stderr |     app = create_app()
2024-06-13 13:16:42 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:16:42 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:16:42 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:16:42 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:16:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 7, in <module>
2024-06-13 13:16:42 | ERROR | stderr |     from configs import (LLM_MODELS,
2024-06-13 13:16:42 | ERROR | stderr | ImportError: cannot import name 'SCORE_THRESHOLD' from 'configs' (/home/00_rag/fufan-chat-api/configs/__init__.py)
2024-06-13 13:17:26 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:17:26 | INFO | stdout | [32mINFO[0m:     192.168.110.131:57996 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:17:40 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (191542)' pid=191542 parent=191114 started daemon>}
2024-06-13 13:17:40 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:17:40 | WARNING | controller | Sending SIGKILL to <Process name='controller (191463)' pid=191463 parent=191114 started daemon>
2024-06-13 13:17:40 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (191541)' pid=191541 parent=191114 stopped exitcode=1 daemon>
2024-06-13 13:17:40 | WARNING | controller | Sending SIGKILL to <Process name='API Server (191677)' pid=191677 parent=191114 stopped exitcode=1 daemon>
2024-06-13 13:17:40 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (191542)' pid=191542 parent=191114 started daemon>}
2024-06-13 13:17:40 | INFO | controller | Process status: {}
2024-06-13 13:17:40 | INFO | controller | Process status: <Process name='controller (191463)' pid=191463 parent=191114 started daemon>
2024-06-13 13:17:40 | INFO | controller | Process status: <Process name='openai_api (191541)' pid=191541 parent=191114 stopped exitcode=1 daemon>
2024-06-13 13:17:40 | INFO | controller | Process status: <Process name='API Server (191677)' pid=191677 parent=191114 stopped exitcode=1 daemon>
2024-06-13 13:17:40 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:17:40 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:17:40 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:17:40 | ERROR | stderr |     api_started.wait()
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:17:40 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:17:40 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:17:40 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:17:40 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:17:40 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:17:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:17:40 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:17:40 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:17:40 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:17:40 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:17:40 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:17:40 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:17:40 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fa237a26660>
2024-06-13 13:17:40 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:17:40 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:17:40 | ERROR | stderr |     finalizer()
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:17:40 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:17:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:17:40 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:17:40 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:17:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:17:40 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:17:40 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:17:40 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:17:40 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:17:40 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:17:40 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:17:40 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:17:40 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:17:45 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:17:45 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:17:46 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:17:46 | ERROR | stderr | 
2024-06-13 13:17:46 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:17:46 | ERROR | stderr |   warnings.warn(
2024-06-13 13:17:46 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m192729[0m]
2024-06-13 13:17:46 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:17:46 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:17:46 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:17:48 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:17:48 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:17:48 | INFO | stdout | [32mINFO[0m:     192.168.110.131:58142 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:17:48 | ERROR | stderr | Process openai_api:
2024-06-13 13:17:48 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:48 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:17:48 | ERROR | stderr |     self.run()
2024-06-13 13:17:48 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:17:48 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:17:48 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 171, in run_openai_api
2024-06-13 13:17:48 | ERROR | stderr |     app = create_openai_api_app(controller_addr, log_level=log_level)
2024-06-13 13:17:48 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:48 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 189, in create_openai_api_app
2024-06-13 13:17:48 | ERROR | stderr |     from fastchat.serve.openai_api_server import app, CORSMiddleware, app_settings
2024-06-13 13:17:48 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/fastchat/serve/openai_api_server.py", line 39, in <module>
2024-06-13 13:17:48 | ERROR | stderr |     from fastchat.protocol.openai_api_protocol import (
2024-06-13 13:17:48 | ERROR | stderr | ModuleNotFoundError: No module named 'fastchat.protocol'
2024-06-13 13:17:50 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:17:50 | ERROR | stderr | 
2024-06-13 13:17:50 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:17:50 | ERROR | stderr |   warnings.warn(
2024-06-13 13:17:50 | ERROR | stderr | Process API Server:
2024-06-13 13:17:50 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:17:50 | ERROR | stderr |     self.run()
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:17:50 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:17:50 | ERROR | stderr |     app = create_app()
2024-06-13 13:17:50 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:17:50 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:17:50 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:17:50 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:17:50 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 7, in <module>
2024-06-13 13:17:50 | ERROR | stderr |     from configs import (LLM_MODELS,
2024-06-13 13:17:50 | ERROR | stderr | ImportError: cannot import name 'USE_RERANKER' from 'configs' (/home/00_rag/fufan-chat-api/configs/__init__.py)
2024-06-13 13:17:59 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (192834)' pid=192834 parent=192520 started daemon>}
2024-06-13 13:17:59 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:17:59 | WARNING | controller | Sending SIGKILL to <Process name='controller (192729)' pid=192729 parent=192520 started daemon>
2024-06-13 13:17:59 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (192833)' pid=192833 parent=192520 stopped exitcode=1 daemon>
2024-06-13 13:17:59 | WARNING | controller | Sending SIGKILL to <Process name='API Server (192974)' pid=192974 parent=192520 stopped exitcode=1 daemon>
2024-06-13 13:17:59 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (192834)' pid=192834 parent=192520 started daemon>}
2024-06-13 13:17:59 | INFO | controller | Process status: {}
2024-06-13 13:17:59 | INFO | controller | Process status: <Process name='controller (192729)' pid=192729 parent=192520 started daemon>
2024-06-13 13:17:59 | INFO | controller | Process status: <Process name='openai_api (192833)' pid=192833 parent=192520 stopped exitcode=1 daemon>
2024-06-13 13:17:59 | INFO | controller | Process status: <Process name='API Server (192974)' pid=192974 parent=192520 stopped exitcode=1 daemon>
2024-06-13 13:17:59 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:17:59 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:17:59 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:17:59 | ERROR | stderr |     api_started.wait()
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:17:59 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:17:59 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:17:59 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:17:59 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:17:59 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:17:59 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:17:59 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:17:59 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:17:59 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:17:59 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:17:59 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:17:59 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:17:59 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fd1db22a660>
2024-06-13 13:17:59 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:17:59 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:17:59 | ERROR | stderr |     finalizer()
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:17:59 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:17:59 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:17:59 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:17:59 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:17:59 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:17:59 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:17:59 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:17:59 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:17:59 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:17:59 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:17:59 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:17:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:17:59 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:17:59 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:18:04 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:18:04 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:18:06 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:18:06 | ERROR | stderr | 
2024-06-13 13:18:06 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:18:06 | ERROR | stderr |   warnings.warn(
2024-06-13 13:18:06 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m193352[0m]
2024-06-13 13:18:06 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:18:06 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:18:06 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:18:07 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:18:07 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:18:07 | INFO | stdout | [32mINFO[0m:     192.168.110.131:41644 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:18:07 | ERROR | stderr | Process openai_api:
2024-06-13 13:18:07 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:18:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:18:07 | ERROR | stderr |     self.run()
2024-06-13 13:18:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:18:07 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:18:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 171, in run_openai_api
2024-06-13 13:18:07 | ERROR | stderr |     app = create_openai_api_app(controller_addr, log_level=log_level)
2024-06-13 13:18:07 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 189, in create_openai_api_app
2024-06-13 13:18:07 | ERROR | stderr |     from fastchat.serve.openai_api_server import app, CORSMiddleware, app_settings
2024-06-13 13:18:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/fastchat/serve/openai_api_server.py", line 39, in <module>
2024-06-13 13:18:07 | ERROR | stderr |     from fastchat.protocol.openai_api_protocol import (
2024-06-13 13:18:07 | ERROR | stderr | ModuleNotFoundError: No module named 'fastchat.protocol'
2024-06-13 13:18:09 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:18:09 | ERROR | stderr | 
2024-06-13 13:18:09 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:18:09 | ERROR | stderr |   warnings.warn(
2024-06-13 13:18:09 | ERROR | stderr | Process API Server:
2024-06-13 13:18:09 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:18:09 | ERROR | stderr |     self.run()
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:18:09 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:18:09 | ERROR | stderr |     app = create_app()
2024-06-13 13:18:09 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:18:09 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:18:09 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:18:09 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 11, in <module>
2024-06-13 13:18:09 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:18:09 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:18:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py", line 10, in <module>
2024-06-13 13:18:09 | ERROR | stderr |     async def load_kb_from_db(session: AsyncSession, kb_name: str):
2024-06-13 13:18:09 | ERROR | stderr |                                        ^^^^^^^^^^^^
2024-06-13 13:18:09 | ERROR | stderr | NameError: name 'AsyncSession' is not defined
2024-06-13 13:18:19 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (193529)' pid=193529 parent=193204 started daemon>}
2024-06-13 13:18:19 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:18:19 | WARNING | controller | Sending SIGKILL to <Process name='controller (193352)' pid=193352 parent=193204 started daemon>
2024-06-13 13:18:19 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (193528)' pid=193528 parent=193204 stopped exitcode=1 daemon>
2024-06-13 13:18:19 | WARNING | controller | Sending SIGKILL to <Process name='API Server (193663)' pid=193663 parent=193204 stopped exitcode=1 daemon>
2024-06-13 13:18:19 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (193529)' pid=193529 parent=193204 started daemon>}
2024-06-13 13:18:19 | INFO | controller | Process status: {}
2024-06-13 13:18:19 | INFO | controller | Process status: <Process name='controller (193352)' pid=193352 parent=193204 started daemon>
2024-06-13 13:18:19 | INFO | controller | Process status: <Process name='openai_api (193528)' pid=193528 parent=193204 stopped exitcode=1 daemon>
2024-06-13 13:18:19 | INFO | controller | Process status: <Process name='API Server (193663)' pid=193663 parent=193204 stopped exitcode=1 daemon>
2024-06-13 13:18:19 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:18:19 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:18:19 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:18:19 | ERROR | stderr |     api_started.wait()
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:18:19 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:18:19 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:18:19 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:18:19 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:18:19 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:18:19 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:18:19 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:18:19 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:18:19 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:18:19 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:18:19 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:18:19 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:18:19 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f9b94f46660>
2024-06-13 13:18:19 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:18:19 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:18:19 | ERROR | stderr |     finalizer()
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:18:19 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:18:19 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:18:19 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:18:19 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:18:19 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:18:19 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:18:19 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:18:19 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:18:19 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:18:19 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:18:19 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:18:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:18:19 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:18:19 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:18:58 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:18:58 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:19:00 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:19:00 | ERROR | stderr | 
2024-06-13 13:19:00 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:19:00 | ERROR | stderr |   warnings.warn(
2024-06-13 13:19:00 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m194535[0m]
2024-06-13 13:19:00 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:19:00 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:19:00 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:19:02 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:19:02 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:19:02 | INFO | stdout | [32mINFO[0m:     192.168.110.131:55888 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:19:02 | ERROR | stderr | Process openai_api:
2024-06-13 13:19:02 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:19:02 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:19:02 | ERROR | stderr |     self.run()
2024-06-13 13:19:02 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:19:02 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:19:02 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 171, in run_openai_api
2024-06-13 13:19:02 | ERROR | stderr |     app = create_openai_api_app(controller_addr, log_level=log_level)
2024-06-13 13:19:02 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:02 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 189, in create_openai_api_app
2024-06-13 13:19:02 | ERROR | stderr |     from fastchat.serve.openai_api_server import app, CORSMiddleware, app_settings
2024-06-13 13:19:02 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/fastchat/serve/openai_api_server.py", line 39, in <module>
2024-06-13 13:19:02 | ERROR | stderr |     from fastchat.protocol.openai_api_protocol import (
2024-06-13 13:19:02 | ERROR | stderr | ModuleNotFoundError: No module named 'fastchat.protocol'
2024-06-13 13:19:03 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name" has conflict with protected namespace "model_".
2024-06-13 13:19:03 | ERROR | stderr | 
2024-06-13 13:19:03 | ERROR | stderr | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
2024-06-13 13:19:03 | ERROR | stderr |   warnings.warn(
2024-06-13 13:19:03 | ERROR | stderr | Process API Server:
2024-06-13 13:19:03 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:19:03 | ERROR | stderr |     self.run()
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:19:03 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:19:03 | ERROR | stderr |     app = create_app()
2024-06-13 13:19:03 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:19:03 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:19:03 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:19:03 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:19:03 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:19:03 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:19:03 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py", line 10, in <module>
2024-06-13 13:19:03 | ERROR | stderr |     async def load_kb_from_db(session: AsyncSession, kb_name: str):
2024-06-13 13:19:03 | ERROR | stderr |                                        ^^^^^^^^^^^^
2024-06-13 13:19:03 | ERROR | stderr | NameError: name 'AsyncSession' is not defined
2024-06-13 13:19:41 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (194608)' pid=194608 parent=194304 started daemon>}
2024-06-13 13:19:41 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:19:42 | WARNING | controller | Sending SIGKILL to <Process name='controller (194535)' pid=194535 parent=194304 started daemon>
2024-06-13 13:19:42 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (194607)' pid=194607 parent=194304 stopped exitcode=1 daemon>
2024-06-13 13:19:42 | WARNING | controller | Sending SIGKILL to <Process name='API Server (194742)' pid=194742 parent=194304 stopped exitcode=1 daemon>
2024-06-13 13:19:42 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (194608)' pid=194608 parent=194304 started daemon>}
2024-06-13 13:19:42 | INFO | controller | Process status: {}
2024-06-13 13:19:42 | INFO | controller | Process status: <Process name='controller (194535)' pid=194535 parent=194304 started daemon>
2024-06-13 13:19:42 | INFO | controller | Process status: <Process name='openai_api (194607)' pid=194607 parent=194304 stopped exitcode=1 daemon>
2024-06-13 13:19:42 | INFO | controller | Process status: <Process name='API Server (194742)' pid=194742 parent=194304 stopped exitcode=1 daemon>
2024-06-13 13:19:42 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:19:42 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:19:42 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:19:42 | ERROR | stderr |     api_started.wait()
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:19:42 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:19:42 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:19:42 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:19:42 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:19:42 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:19:42 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:19:42 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:19:42 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:19:42 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:19:42 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:19:42 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:19:42 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:19:42 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fc824ef6660>
2024-06-13 13:19:42 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:19:42 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:19:42 | ERROR | stderr |     finalizer()
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:19:42 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:19:42 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:19:42 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:19:42 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:19:42 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:19:42 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:19:42 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:19:42 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:19:42 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:19:42 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:19:42 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:19:42 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:19:42 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:19:42 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:21:05 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:21:05 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:21:07 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m197228[0m]
2024-06-13 13:21:07 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:21:07 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:21:07 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:21:08 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:21:08 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:21:08 | INFO | stdout | [32mINFO[0m:     192.168.110.131:34250 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:21:08 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m197300[0m]
2024-06-13 13:21:08 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:21:08 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:21:08 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:21:10 | ERROR | stderr | Process API Server:
2024-06-13 13:21:10 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:21:10 | ERROR | stderr |     self.run()
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:21:10 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:21:10 | ERROR | stderr |     app = create_app()
2024-06-13 13:21:10 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:21:10 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:21:10 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:21:10 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:21:10 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:21:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:21:10 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:21:10 | ERROR | stderr | ImportError: cannot import name 'add_kb_to_db' from 'server.db.repository.knowledge_base_repository' (/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py)
2024-06-13 13:21:53 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:21:53 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42592 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:22:38 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:22:38 | INFO | stdout | [32mINFO[0m:     192.168.110.131:41704 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:23:23 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:23:23 | INFO | stdout | [32mINFO[0m:     192.168.110.131:43436 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:24:08 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:24:08 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35070 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:24:46 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (197301)' pid=197301 parent=196824 started daemon>}
2024-06-13 13:24:46 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:24:46 | WARNING | controller | Sending SIGKILL to <Process name='controller (197228)' pid=197228 parent=196824 started daemon>
2024-06-13 13:24:46 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (197300)' pid=197300 parent=196824 started daemon>
2024-06-13 13:24:46 | WARNING | controller | Sending SIGKILL to <Process name='API Server (197468)' pid=197468 parent=196824 stopped exitcode=1 daemon>
2024-06-13 13:24:46 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (197301)' pid=197301 parent=196824 started daemon>}
2024-06-13 13:24:46 | INFO | controller | Process status: {}
2024-06-13 13:24:46 | INFO | controller | Process status: <Process name='controller (197228)' pid=197228 parent=196824 started daemon>
2024-06-13 13:24:46 | INFO | controller | Process status: <Process name='openai_api (197300)' pid=197300 parent=196824 started daemon>
2024-06-13 13:24:46 | INFO | controller | Process status: <Process name='API Server (197468)' pid=197468 parent=196824 stopped exitcode=1 daemon>
2024-06-13 13:24:46 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:24:46 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:24:46 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:24:46 | ERROR | stderr |     api_started.wait()
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:24:46 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:24:46 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:24:46 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:24:46 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:24:46 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:24:46 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:24:46 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:24:46 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:24:46 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:24:46 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:24:46 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:24:46 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:24:46 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f0808ea76a0>
2024-06-13 13:24:46 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:24:46 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:24:46 | ERROR | stderr |     finalizer()
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:24:46 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:24:46 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:24:46 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:24:46 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:24:46 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:24:46 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:24:46 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:24:46 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:24:46 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:24:46 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:24:46 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:24:46 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:24:46 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:24:46 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:24:50 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:24:50 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:24:51 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m200150[0m]
2024-06-13 13:24:51 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:24:51 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:24:51 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:24:53 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:24:53 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:24:53 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35852 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:24:53 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m200254[0m]
2024-06-13 13:24:53 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:24:53 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:24:53 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:24:54 | ERROR | stderr | Process API Server:
2024-06-13 13:24:54 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:24:54 | ERROR | stderr |     self.run()
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:24:54 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:24:54 | ERROR | stderr |     app = create_app()
2024-06-13 13:24:54 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:24:54 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:24:54 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:24:54 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:24:54 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:24:54 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:24:54 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:24:54 | ERROR | stderr | ImportError: cannot import name 'add_kb_to_db' from 'server.db.repository.knowledge_base_repository' (/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py)
2024-06-13 13:25:24 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (200255)' pid=200255 parent=199960 started daemon>}
2024-06-13 13:25:24 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:25:24 | WARNING | controller | Sending SIGKILL to <Process name='controller (200150)' pid=200150 parent=199960 started daemon>
2024-06-13 13:25:24 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (200254)' pid=200254 parent=199960 started daemon>
2024-06-13 13:25:24 | WARNING | controller | Sending SIGKILL to <Process name='API Server (200389)' pid=200389 parent=199960 stopped exitcode=1 daemon>
2024-06-13 13:25:24 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (200255)' pid=200255 parent=199960 started daemon>}
2024-06-13 13:25:24 | INFO | controller | Process status: {}
2024-06-13 13:25:24 | INFO | controller | Process status: <Process name='controller (200150)' pid=200150 parent=199960 started daemon>
2024-06-13 13:25:24 | INFO | controller | Process status: <Process name='openai_api (200254)' pid=200254 parent=199960 started daemon>
2024-06-13 13:25:24 | INFO | controller | Process status: <Process name='API Server (200389)' pid=200389 parent=199960 stopped exitcode=1 daemon>
2024-06-13 13:25:24 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:25:24 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:25:24 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:25:24 | ERROR | stderr |     api_started.wait()
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:25:24 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:25:24 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:25:24 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:25:24 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:25:24 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:25:24 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:25:24 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:25:24 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:25:24 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:25:24 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:24 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:25:24 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:25:24 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:25:25 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fb291a036a0>
2024-06-13 13:25:25 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:25:25 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:25:25 | ERROR | stderr |     finalizer()
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:25:25 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:25:25 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:25:25 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:25:25 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:25:25 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:25:25 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:25:25 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:25:25 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:25:25 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:25:25 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:25:25 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:25:25 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:25:25 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:25:25 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:25:29 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:25:29 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:25:30 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m201273[0m]
2024-06-13 13:25:30 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:25:30 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:25:30 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:25:32 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:25:32 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:25:32 | INFO | stdout | [32mINFO[0m:     192.168.110.131:38024 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:25:32 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m201412[0m]
2024-06-13 13:25:32 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:25:32 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:25:32 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:25:33 | ERROR | stderr | Process API Server:
2024-06-13 13:25:33 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:25:33 | ERROR | stderr |     self.run()
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:25:33 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:25:33 | ERROR | stderr |     app = create_app()
2024-06-13 13:25:33 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:25:33 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:25:33 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:25:33 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:25:33 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:25:33 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:25:33 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:25:33 | ERROR | stderr | ImportError: cannot import name 'add_kb_to_db' from 'server.db.repository.knowledge_base_repository' (/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py)
2024-06-13 13:26:16 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (201413)' pid=201413 parent=201131 started daemon>}
2024-06-13 13:26:16 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:26:16 | WARNING | controller | Sending SIGKILL to <Process name='controller (201273)' pid=201273 parent=201131 started daemon>
2024-06-13 13:26:16 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (201412)' pid=201412 parent=201131 started daemon>
2024-06-13 13:26:16 | WARNING | controller | Sending SIGKILL to <Process name='API Server (201578)' pid=201578 parent=201131 stopped exitcode=1 daemon>
2024-06-13 13:26:16 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (201413)' pid=201413 parent=201131 started daemon>}
2024-06-13 13:26:16 | INFO | controller | Process status: {}
2024-06-13 13:26:16 | INFO | controller | Process status: <Process name='controller (201273)' pid=201273 parent=201131 started daemon>
2024-06-13 13:26:16 | INFO | controller | Process status: <Process name='openai_api (201412)' pid=201412 parent=201131 started daemon>
2024-06-13 13:26:16 | INFO | controller | Process status: <Process name='API Server (201578)' pid=201578 parent=201131 stopped exitcode=1 daemon>
2024-06-13 13:26:16 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:26:16 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:26:16 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:26:16 | ERROR | stderr |     api_started.wait()
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:26:16 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:26:16 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:26:16 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:26:16 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:26:16 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:26:16 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:26:16 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:26:16 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:26:16 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:26:16 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:16 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:26:16 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:26:16 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:26:23 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:26:23 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:26:24 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m202420[0m]
2024-06-13 13:26:24 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:26:24 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:26:24 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:26:26 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:26:26 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:26:26 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35732 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:26:26 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m202498[0m]
2024-06-13 13:26:26 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:26:26 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:26:26 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:26:27 | ERROR | stderr | Process API Server:
2024-06-13 13:26:27 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:26:27 | ERROR | stderr |     self.run()
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:26:27 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:26:27 | ERROR | stderr |     app = create_app()
2024-06-13 13:26:27 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:26:27 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:26:27 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:26:27 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:26:27 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 43
2024-06-13 13:26:27 | ERROR | stderr |     # history = [History.from_data(h) for h in history]
2024-06-13 13:26:27 | ERROR | stderr |                                                        ^
2024-06-13 13:26:27 | ERROR | stderr | IndentationError: expected an indented block after function definition on line 12
2024-06-13 13:26:34 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (202499)' pid=202499 parent=202157 started daemon>}
2024-06-13 13:26:34 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:26:34 | WARNING | controller | Sending SIGKILL to <Process name='controller (202420)' pid=202420 parent=202157 started daemon>
2024-06-13 13:26:34 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (202498)' pid=202498 parent=202157 started daemon>
2024-06-13 13:26:34 | WARNING | controller | Sending SIGKILL to <Process name='API Server (202633)' pid=202633 parent=202157 stopped exitcode=1 daemon>
2024-06-13 13:26:34 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (202499)' pid=202499 parent=202157 started daemon>}
2024-06-13 13:26:34 | INFO | controller | Process status: {}
2024-06-13 13:26:34 | INFO | controller | Process status: <Process name='controller (202420)' pid=202420 parent=202157 started daemon>
2024-06-13 13:26:34 | INFO | controller | Process status: <Process name='openai_api (202498)' pid=202498 parent=202157 started daemon>
2024-06-13 13:26:34 | INFO | controller | Process status: <Process name='API Server (202633)' pid=202633 parent=202157 stopped exitcode=1 daemon>
2024-06-13 13:26:34 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:26:34 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:26:34 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:26:34 | ERROR | stderr |     api_started.wait()
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:26:34 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:26:34 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:26:34 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:26:34 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:26:34 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:26:34 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:26:34 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:26:34 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:26:34 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:26:34 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:26:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:26:34 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:26:34 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:26:38 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:26:38 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:26:39 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m203000[0m]
2024-06-13 13:26:39 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:26:39 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:26:39 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:26:41 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:26:41 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:26:41 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42058 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:26:41 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m203077[0m]
2024-06-13 13:26:41 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:26:41 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:26:41 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:26:42 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m203213[0m]
2024-06-13 13:26:42 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:26:42 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:26:42 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:8000[0m (Press CTRL+C to quit)
2024-06-13 13:26:56 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59454 - "[1mGET /docs HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:26:56 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59454 - "[1mGET /openapi.json HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:27:09 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (203079)' pid=203079 parent=202820 started daemon>}
2024-06-13 13:27:09 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:27:09 | WARNING | controller | Sending SIGKILL to <Process name='controller (203000)' pid=203000 parent=202820 started daemon>
2024-06-13 13:27:09 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (203077)' pid=203077 parent=202820 started daemon>
2024-06-13 13:27:09 | WARNING | controller | Sending SIGKILL to <Process name='API Server (203213)' pid=203213 parent=202820 started daemon>
2024-06-13 13:27:09 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (203079)' pid=203079 parent=202820 started daemon>}
2024-06-13 13:27:09 | INFO | controller | Process status: {}
2024-06-13 13:27:09 | INFO | controller | Process status: <Process name='controller (203000)' pid=203000 parent=202820 started daemon>
2024-06-13 13:27:09 | INFO | controller | Process status: <Process name='openai_api (203077)' pid=203077 parent=202820 started daemon>
2024-06-13 13:27:09 | INFO | controller | Process status: <Process name='API Server (203213)' pid=203213 parent=202820 started daemon>
2024-06-13 13:27:09 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:27:09 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:27:09 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 492, in start_main_server
2024-06-13 13:27:09 | ERROR | stderr |     cmd = queue.get()
2024-06-13 13:27:09 | ERROR | stderr |           ^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "<string>", line 2, in get
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:27:09 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:27:09 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:27:09 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:27:09 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:27:09 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:27:09 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:27:09 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:27:09 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:09 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:27:09 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:27:09 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:27:10 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f64dd5e36a0>
2024-06-13 13:27:10 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:27:10 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:27:10 | ERROR | stderr |     finalizer()
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:27:10 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:27:10 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:27:10 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:27:10 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:27:10 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:27:10 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:27:10 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:27:10 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:27:10 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:27:10 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:27:10 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:27:10 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:27:10 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:27:10 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:27:55 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:27:55 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:27:56 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m204399[0m]
2024-06-13 13:27:56 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:27:56 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:27:56 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:27:58 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:27:58 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:27:58 | INFO | stdout | [32mINFO[0m:     192.168.110.131:32770 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:27:58 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m204525[0m]
2024-06-13 13:27:58 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:27:58 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:27:58 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:27:59 | ERROR | stderr | Process API Server:
2024-06-13 13:27:59 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:27:59 | ERROR | stderr |     self.run()
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:27:59 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:27:59 | ERROR | stderr |     app = create_app()
2024-06-13 13:27:59 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:27:59 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:27:59 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:27:59 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:27:59 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:27:59 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:27:59 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import (
2024-06-13 13:27:59 | ERROR | stderr | ImportError: cannot import name 'add_kb_to_db' from 'server.db.repository.knowledge_base_repository' (/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py)
2024-06-13 13:28:43 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:28:43 | INFO | stdout | [32mINFO[0m:     192.168.110.131:37054 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:29:28 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:29:28 | INFO | stdout | [32mINFO[0m:     192.168.110.131:37852 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:30:00 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (204526)' pid=204526 parent=204219 started daemon>}
2024-06-13 13:30:00 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:30:00 | WARNING | controller | Sending SIGKILL to <Process name='controller (204399)' pid=204399 parent=204219 started daemon>
2024-06-13 13:30:00 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (204525)' pid=204525 parent=204219 started daemon>
2024-06-13 13:30:00 | WARNING | controller | Sending SIGKILL to <Process name='API Server (204660)' pid=204660 parent=204219 stopped exitcode=1 daemon>
2024-06-13 13:30:00 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (204526)' pid=204526 parent=204219 started daemon>}
2024-06-13 13:30:00 | INFO | controller | Process status: {}
2024-06-13 13:30:00 | INFO | controller | Process status: <Process name='controller (204399)' pid=204399 parent=204219 started daemon>
2024-06-13 13:30:00 | INFO | controller | Process status: <Process name='openai_api (204525)' pid=204525 parent=204219 started daemon>
2024-06-13 13:30:00 | INFO | controller | Process status: <Process name='API Server (204660)' pid=204660 parent=204219 stopped exitcode=1 daemon>
2024-06-13 13:30:00 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:30:00 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:30:00 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:30:00 | ERROR | stderr |     api_started.wait()
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:30:00 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:30:00 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:30:00 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:30:00 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:30:00 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:30:00 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:30:00 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:30:00 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:30:00 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:30:00 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:30:00 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:30:00 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:30:00 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f84c17236a0>
2024-06-13 13:30:00 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:30:00 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:30:00 | ERROR | stderr |     finalizer()
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:30:00 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:30:00 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:30:00 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:30:00 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:30:00 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:30:00 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:30:00 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:30:00 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:30:00 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:30:00 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:30:00 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:30:00 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:30:00 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:30:00 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:30:04 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:30:04 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:30:05 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m206355[0m]
2024-06-13 13:30:05 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:30:05 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:30:05 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:30:07 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:30:07 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:30:07 | INFO | stdout | [32mINFO[0m:     192.168.110.131:37310 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:30:07 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m206548[0m]
2024-06-13 13:30:07 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:30:07 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:30:07 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:30:08 | ERROR | stderr | Process API Server:
2024-06-13 13:30:08 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:30:08 | ERROR | stderr |     self.run()
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:30:08 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:30:08 | ERROR | stderr |     app = create_app()
2024-06-13 13:30:08 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:30:08 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:30:08 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:30:08 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:30:08 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:30:08 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 10, in <module>
2024-06-13 13:30:08 | ERROR | stderr |     from server.db.repository.knowledge_base_repository import add_kb_to_db
2024-06-13 13:30:08 | ERROR | stderr | ImportError: cannot import name 'add_kb_to_db' from 'server.db.repository.knowledge_base_repository' (/home/00_rag/fufan-chat-api/server/db/repository/knowledge_base_repository.py)
2024-06-13 13:30:52 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:30:52 | INFO | stdout | [32mINFO[0m:     192.168.110.131:53420 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:31:11 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (206549)' pid=206549 parent=206213 started daemon>}
2024-06-13 13:31:11 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:31:11 | WARNING | controller | Sending SIGKILL to <Process name='controller (206355)' pid=206355 parent=206213 started daemon>
2024-06-13 13:31:11 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (206548)' pid=206548 parent=206213 started daemon>
2024-06-13 13:31:11 | WARNING | controller | Sending SIGKILL to <Process name='API Server (206683)' pid=206683 parent=206213 stopped exitcode=1 daemon>
2024-06-13 13:31:11 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (206549)' pid=206549 parent=206213 started daemon>}
2024-06-13 13:31:11 | INFO | controller | Process status: {}
2024-06-13 13:31:11 | INFO | controller | Process status: <Process name='controller (206355)' pid=206355 parent=206213 started daemon>
2024-06-13 13:31:11 | INFO | controller | Process status: <Process name='openai_api (206548)' pid=206548 parent=206213 started daemon>
2024-06-13 13:31:11 | INFO | controller | Process status: <Process name='API Server (206683)' pid=206683 parent=206213 stopped exitcode=1 daemon>
2024-06-13 13:31:11 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:31:11 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:31:11 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:31:11 | ERROR | stderr |     api_started.wait()
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:31:11 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:31:11 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:31:11 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:31:11 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:31:11 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:31:11 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:31:11 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:31:11 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:31:11 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:31:11 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:31:11 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:31:11 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:31:11 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fe5d38e36a0>
2024-06-13 13:31:11 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:31:11 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:31:11 | ERROR | stderr |     finalizer()
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:31:11 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:31:11 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:31:11 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:31:11 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:31:11 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:31:11 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:31:11 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:31:11 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:31:11 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:31:11 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:31:11 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:31:11 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:31:11 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:31:11 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:31:15 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:31:15 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:31:16 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m207763[0m]
2024-06-13 13:31:16 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:31:16 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:31:16 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:31:17 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:31:17 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:31:17 | INFO | stdout | [32mINFO[0m:     192.168.110.131:43754 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:31:18 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m207873[0m]
2024-06-13 13:31:18 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:31:18 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:31:18 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:31:19 | ERROR | stderr | Process API Server:
2024-06-13 13:31:19 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:31:19 | ERROR | stderr |     self.run()
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:31:19 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:31:19 | ERROR | stderr |     app = create_app()
2024-06-13 13:31:19 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:31:19 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:31:19 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:31:19 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:31:19 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 35, in <module>
2024-06-13 13:31:19 | ERROR | stderr |     class KBService(ABC):
2024-06-13 13:31:19 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 39, in KBService
2024-06-13 13:31:19 | ERROR | stderr |     embed_model: str = EMBEDDING_MODEL,
2024-06-13 13:31:19 | ERROR | stderr |                        ^^^^^^^^^^^^^^^
2024-06-13 13:31:19 | ERROR | stderr | NameError: name 'EMBEDDING_MODEL' is not defined
2024-06-13 13:32:02 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:32:02 | INFO | stdout | [32mINFO[0m:     192.168.110.131:38528 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:32:30 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (207874)' pid=207874 parent=207562 started daemon>}
2024-06-13 13:32:30 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:32:30 | WARNING | controller | Sending SIGKILL to <Process name='controller (207763)' pid=207763 parent=207562 started daemon>
2024-06-13 13:32:30 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (207873)' pid=207873 parent=207562 started daemon>
2024-06-13 13:32:30 | WARNING | controller | Sending SIGKILL to <Process name='API Server (208008)' pid=208008 parent=207562 stopped exitcode=1 daemon>
2024-06-13 13:32:30 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (207874)' pid=207874 parent=207562 started daemon>}
2024-06-13 13:32:30 | INFO | controller | Process status: {}
2024-06-13 13:32:30 | INFO | controller | Process status: <Process name='controller (207763)' pid=207763 parent=207562 started daemon>
2024-06-13 13:32:30 | INFO | controller | Process status: <Process name='openai_api (207873)' pid=207873 parent=207562 started daemon>
2024-06-13 13:32:30 | INFO | controller | Process status: <Process name='API Server (208008)' pid=208008 parent=207562 stopped exitcode=1 daemon>
2024-06-13 13:32:30 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:32:30 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:32:30 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:32:30 | ERROR | stderr |     api_started.wait()
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:32:30 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:32:30 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:32:30 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:32:30 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:32:30 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:32:30 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:32:30 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:32:30 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:32:30 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:32:30 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:32:30 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:32:30 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:32:30 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f46c06576a0>
2024-06-13 13:32:30 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:32:30 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:32:30 | ERROR | stderr |     finalizer()
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:32:30 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:32:30 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:32:30 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:32:30 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:32:30 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:32:30 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:32:30 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:32:30 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:32:30 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:32:30 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:32:30 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:32:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:32:30 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:32:30 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:33:26 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:33:26 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:33:27 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m209999[0m]
2024-06-13 13:33:27 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:33:27 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:33:27 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:33:29 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:33:29 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:33:29 | INFO | stdout | [32mINFO[0m:     192.168.110.131:52412 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:33:29 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m210079[0m]
2024-06-13 13:33:29 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:33:29 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:33:29 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:33:30 | ERROR | stderr | Process API Server:
2024-06-13 13:33:30 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:33:30 | ERROR | stderr |     self.run()
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:33:30 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:33:30 | ERROR | stderr |     app = create_app()
2024-06-13 13:33:30 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:33:30 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:33:30 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:33:30 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:33:30 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:33:30 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 14, in <module>
2024-06-13 13:33:30 | ERROR | stderr |     from configs import (kbs_config, VECTOR_SEARCH_TOP_K, SCORE_THRESHOLD,
2024-06-13 13:33:30 | ERROR | stderr | ImportError: cannot import name 'kbs_config' from 'configs' (/home/00_rag/fufan-chat-api/configs/__init__.py)
2024-06-13 13:33:44 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (210080)' pid=210080 parent=209851 started daemon>}
2024-06-13 13:33:44 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:33:44 | WARNING | controller | Sending SIGKILL to <Process name='controller (209999)' pid=209999 parent=209851 started daemon>
2024-06-13 13:33:44 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (210079)' pid=210079 parent=209851 started daemon>
2024-06-13 13:33:44 | WARNING | controller | Sending SIGKILL to <Process name='API Server (210302)' pid=210302 parent=209851 stopped exitcode=1 daemon>
2024-06-13 13:33:44 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (210080)' pid=210080 parent=209851 started daemon>}
2024-06-13 13:33:44 | INFO | controller | Process status: {}
2024-06-13 13:33:44 | INFO | controller | Process status: <Process name='controller (209999)' pid=209999 parent=209851 started daemon>
2024-06-13 13:33:44 | INFO | controller | Process status: <Process name='openai_api (210079)' pid=210079 parent=209851 started daemon>
2024-06-13 13:33:44 | INFO | controller | Process status: <Process name='API Server (210302)' pid=210302 parent=209851 stopped exitcode=1 daemon>
2024-06-13 13:33:44 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:33:44 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:33:44 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:33:44 | ERROR | stderr |     api_started.wait()
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:33:44 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:33:44 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:33:44 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:33:44 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:33:44 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:33:44 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:33:44 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:33:44 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:33:44 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:33:44 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:33:44 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:33:44 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:33:44 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f16dab276a0>
2024-06-13 13:33:44 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:33:44 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:33:44 | ERROR | stderr |     finalizer()
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:33:44 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:33:44 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:33:44 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:33:44 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:33:44 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:33:44 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:33:44 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:33:44 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:33:44 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:33:44 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:33:44 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:33:44 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:33:44 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:33:44 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:33:47 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:33:47 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:33:49 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m210714[0m]
2024-06-13 13:33:49 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:33:49 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:33:49 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:33:50 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:33:50 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:33:50 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42912 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:33:50 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m210863[0m]
2024-06-13 13:33:50 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:33:50 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:33:50 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:33:52 | ERROR | stderr | Process API Server:
2024-06-13 13:33:52 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:33:52 | ERROR | stderr |     self.run()
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:33:52 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:33:52 | ERROR | stderr |     app = create_app()
2024-06-13 13:33:52 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:33:52 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:33:52 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:33:52 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:33:52 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 38, in <module>
2024-06-13 13:33:52 | ERROR | stderr |     class KBService(ABC):
2024-06-13 13:33:52 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 92, in KBService
2024-06-13 13:33:52 | ERROR | stderr |     def add_doc(self, kb_file: KnowledgeFile, docs: List[Document] = [], **kwargs):
2024-06-13 13:33:52 | ERROR | stderr |                                ^^^^^^^^^^^^^
2024-06-13 13:33:52 | ERROR | stderr | NameError: name 'KnowledgeFile' is not defined
2024-06-13 13:34:35 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:34:35 | INFO | stdout | [32mINFO[0m:     192.168.110.131:44492 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:35:20 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:35:20 | INFO | stdout | [32mINFO[0m:     192.168.110.131:49648 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:36:05 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:36:05 | INFO | stdout | [32mINFO[0m:     192.168.110.131:57590 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:36:50 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:36:50 | INFO | stdout | [32mINFO[0m:     192.168.110.131:46618 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:37:35 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:37:35 | INFO | stdout | [32mINFO[0m:     192.168.110.131:33302 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:37:40 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (210864)' pid=210864 parent=210566 started daemon>}
2024-06-13 13:37:40 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:37:40 | WARNING | controller | Sending SIGKILL to <Process name='controller (210714)' pid=210714 parent=210566 started daemon>
2024-06-13 13:37:40 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (210863)' pid=210863 parent=210566 started daemon>
2024-06-13 13:37:40 | WARNING | controller | Sending SIGKILL to <Process name='API Server (210998)' pid=210998 parent=210566 stopped exitcode=1 daemon>
2024-06-13 13:37:40 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (210864)' pid=210864 parent=210566 started daemon>}
2024-06-13 13:37:40 | INFO | controller | Process status: {}
2024-06-13 13:37:40 | INFO | controller | Process status: <Process name='controller (210714)' pid=210714 parent=210566 started daemon>
2024-06-13 13:37:40 | INFO | controller | Process status: <Process name='openai_api (210863)' pid=210863 parent=210566 started daemon>
2024-06-13 13:37:40 | INFO | controller | Process status: <Process name='API Server (210998)' pid=210998 parent=210566 stopped exitcode=1 daemon>
2024-06-13 13:37:40 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:37:40 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:37:40 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:37:40 | ERROR | stderr |     api_started.wait()
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:37:40 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:37:40 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:37:40 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:37:40 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:37:40 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:37:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:37:40 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:37:40 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:37:40 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:37:40 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:37:40 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:37:40 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:37:40 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fc41b30b6a0>
2024-06-13 13:37:40 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:37:40 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:37:40 | ERROR | stderr |     finalizer()
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:37:40 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:37:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:37:40 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:37:40 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:37:40 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:37:40 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:37:40 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:37:40 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:37:40 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:37:40 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:37:40 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:37:40 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:37:40 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:37:40 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:37:43 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:37:43 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:37:45 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m214121[0m]
2024-06-13 13:37:45 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:37:45 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:37:45 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:37:46 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:37:46 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:37:46 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35500 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:37:46 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m214193[0m]
2024-06-13 13:37:46 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:37:46 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:37:46 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:37:47 | ERROR | stderr | Process API Server:
2024-06-13 13:37:47 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:37:47 | ERROR | stderr |     self.run()
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:37:47 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:37:47 | ERROR | stderr |     app = create_app()
2024-06-13 13:37:47 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:37:47 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:37:47 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:37:47 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:37:47 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 20, in <module>
2024-06-13 13:37:47 | ERROR | stderr |     class KBService(ABC):
2024-06-13 13:37:47 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 74, in KBService
2024-06-13 13:37:47 | ERROR | stderr |     def add_doc(self, kb_file: KnowledgeFile, docs: List[Document] = [], **kwargs):
2024-06-13 13:37:47 | ERROR | stderr |                                ^^^^^^^^^^^^^
2024-06-13 13:37:47 | ERROR | stderr | NameError: name 'KnowledgeFile' is not defined
2024-06-13 13:38:07 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (214194)' pid=214194 parent=213878 started daemon>}
2024-06-13 13:38:07 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:38:07 | WARNING | controller | Sending SIGKILL to <Process name='controller (214121)' pid=214121 parent=213878 started daemon>
2024-06-13 13:38:07 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (214193)' pid=214193 parent=213878 started daemon>
2024-06-13 13:38:07 | WARNING | controller | Sending SIGKILL to <Process name='API Server (214328)' pid=214328 parent=213878 stopped exitcode=1 daemon>
2024-06-13 13:38:07 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (214194)' pid=214194 parent=213878 started daemon>}
2024-06-13 13:38:07 | INFO | controller | Process status: {}
2024-06-13 13:38:07 | INFO | controller | Process status: <Process name='controller (214121)' pid=214121 parent=213878 started daemon>
2024-06-13 13:38:07 | INFO | controller | Process status: <Process name='openai_api (214193)' pid=214193 parent=213878 started daemon>
2024-06-13 13:38:07 | INFO | controller | Process status: <Process name='API Server (214328)' pid=214328 parent=213878 stopped exitcode=1 daemon>
2024-06-13 13:38:07 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:38:07 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:38:07 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:38:07 | ERROR | stderr |     api_started.wait()
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:38:07 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:38:07 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:38:07 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:38:07 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:38:07 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:38:07 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:38:07 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:38:07 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:38:07 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:38:07 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:38:07 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:38:07 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:38:11 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:38:11 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:38:12 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m214842[0m]
2024-06-13 13:38:12 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:38:12 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:38:12 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:38:13 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:38:13 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:38:13 | INFO | stdout | [32mINFO[0m:     192.168.110.131:45610 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:38:14 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m214953[0m]
2024-06-13 13:38:14 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:38:14 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:38:14 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:38:15 | ERROR | stderr | Process API Server:
2024-06-13 13:38:15 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:38:15 | ERROR | stderr |     self.run()
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:38:15 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:38:15 | ERROR | stderr |     app = create_app()
2024-06-13 13:38:15 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:38:15 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:38:15 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:38:15 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:38:15 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 17, in <module>
2024-06-13 13:38:15 | ERROR | stderr |     class KBServiceFactory:
2024-06-13 13:38:15 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 21, in KBServiceFactory
2024-06-13 13:38:15 | ERROR | stderr |     vector_store_type: Union[str, SupportedVSType],
2024-06-13 13:38:15 | ERROR | stderr |                                   ^^^^^^^^^^^^^^^
2024-06-13 13:38:15 | ERROR | stderr | NameError: name 'SupportedVSType' is not defined
2024-06-13 13:38:35 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (214954)' pid=214954 parent=214700 started daemon>}
2024-06-13 13:38:35 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:38:35 | WARNING | controller | Sending SIGKILL to <Process name='controller (214842)' pid=214842 parent=214700 started daemon>
2024-06-13 13:38:35 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (214953)' pid=214953 parent=214700 started daemon>
2024-06-13 13:38:35 | WARNING | controller | Sending SIGKILL to <Process name='API Server (215237)' pid=215237 parent=214700 stopped exitcode=1 daemon>
2024-06-13 13:38:35 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (214954)' pid=214954 parent=214700 started daemon>}
2024-06-13 13:38:35 | INFO | controller | Process status: {}
2024-06-13 13:38:35 | INFO | controller | Process status: <Process name='controller (214842)' pid=214842 parent=214700 started daemon>
2024-06-13 13:38:35 | INFO | controller | Process status: <Process name='openai_api (214953)' pid=214953 parent=214700 started daemon>
2024-06-13 13:38:35 | INFO | controller | Process status: <Process name='API Server (215237)' pid=215237 parent=214700 stopped exitcode=1 daemon>
2024-06-13 13:38:35 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:38:35 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:38:35 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:38:35 | ERROR | stderr |     api_started.wait()
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:38:35 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:38:35 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:38:35 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:38:35 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:38:35 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:38:35 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:38:35 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:38:35 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:38:35 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:38:35 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:35 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:38:35 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:38:35 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:38:36 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fc420c036a0>
2024-06-13 13:38:36 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:38:36 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:38:36 | ERROR | stderr |     finalizer()
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:38:36 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:38:36 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:38:36 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:38:36 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:38:36 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:38:36 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:38:36 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:38:36 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:38:36 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:38:36 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:38:36 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:38:36 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:38:36 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:38:36 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:38:39 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:38:39 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:38:40 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m215691[0m]
2024-06-13 13:38:40 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:38:40 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:38:40 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:38:42 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:38:42 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:38:42 | INFO | stdout | [32mINFO[0m:     192.168.110.131:58664 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:38:42 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m215797[0m]
2024-06-13 13:38:42 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:38:42 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:38:42 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:38:43 | ERROR | stderr | Process API Server:
2024-06-13 13:38:43 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:38:43 | ERROR | stderr |     self.run()
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:38:43 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:38:43 | ERROR | stderr |     app = create_app()
2024-06-13 13:38:43 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:38:43 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:38:43 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:38:43 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:38:43 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 24, in <module>
2024-06-13 13:38:43 | ERROR | stderr |     class KBServiceFactory:
2024-06-13 13:38:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 30, in KBServiceFactory
2024-06-13 13:38:43 | ERROR | stderr |     ) -> KBService:
2024-06-13 13:38:43 | ERROR | stderr |          ^^^^^^^^^
2024-06-13 13:38:43 | ERROR | stderr | NameError: name 'KBService' is not defined
2024-06-13 13:39:25 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (215798)' pid=215798 parent=215543 started daemon>}
2024-06-13 13:39:25 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:39:25 | WARNING | controller | Sending SIGKILL to <Process name='controller (215691)' pid=215691 parent=215543 started daemon>
2024-06-13 13:39:25 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (215797)' pid=215797 parent=215543 started daemon>
2024-06-13 13:39:25 | WARNING | controller | Sending SIGKILL to <Process name='API Server (215972)' pid=215972 parent=215543 stopped exitcode=1 daemon>
2024-06-13 13:39:25 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (215798)' pid=215798 parent=215543 started daemon>}
2024-06-13 13:39:25 | INFO | controller | Process status: {}
2024-06-13 13:39:25 | INFO | controller | Process status: <Process name='controller (215691)' pid=215691 parent=215543 started daemon>
2024-06-13 13:39:25 | INFO | controller | Process status: <Process name='openai_api (215797)' pid=215797 parent=215543 started daemon>
2024-06-13 13:39:25 | INFO | controller | Process status: <Process name='API Server (215972)' pid=215972 parent=215543 stopped exitcode=1 daemon>
2024-06-13 13:39:25 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:39:25 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:39:25 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:39:25 | ERROR | stderr |     api_started.wait()
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:39:25 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:39:25 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:39:25 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:39:25 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:39:25 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:39:25 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:39:25 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:39:25 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:39:25 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:39:25 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:39:25 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:39:25 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:39:25 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f81284d36a0>
2024-06-13 13:39:25 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:39:25 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:39:25 | ERROR | stderr |     finalizer()
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:39:25 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:39:25 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:39:25 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:39:25 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:39:25 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:39:25 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:39:25 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:39:25 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:39:25 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:39:25 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:39:25 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:25 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:39:25 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:39:25 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:39:30 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:39:30 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:39:31 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m216763[0m]
2024-06-13 13:39:31 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:39:31 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:39:31 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:39:33 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:39:33 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:39:33 | INFO | stdout | [32mINFO[0m:     192.168.110.131:43424 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:39:33 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m216882[0m]
2024-06-13 13:39:33 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:39:33 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:39:33 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:39:34 | ERROR | stderr | Process API Server:
2024-06-13 13:39:34 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:39:34 | ERROR | stderr |     self.run()
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:39:34 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:39:34 | ERROR | stderr |     app = create_app()
2024-06-13 13:39:34 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:39:34 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:39:34 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:39:34 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:39:34 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 24, in <module>
2024-06-13 13:39:34 | ERROR | stderr |     class KBServiceFactory:
2024-06-13 13:39:34 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 30, in KBServiceFactory
2024-06-13 13:39:34 | ERROR | stderr |     ) -> KBService:
2024-06-13 13:39:34 | ERROR | stderr |          ^^^^^^^^^
2024-06-13 13:39:34 | ERROR | stderr | NameError: name 'KBService' is not defined
2024-06-13 13:39:45 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (216883)' pid=216883 parent=216621 started daemon>}
2024-06-13 13:39:45 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:39:45 | WARNING | controller | Sending SIGKILL to <Process name='controller (216763)' pid=216763 parent=216621 started daemon>
2024-06-13 13:39:45 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (216882)' pid=216882 parent=216621 started daemon>
2024-06-13 13:39:45 | WARNING | controller | Sending SIGKILL to <Process name='API Server (217056)' pid=217056 parent=216621 stopped exitcode=1 daemon>
2024-06-13 13:39:45 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (216883)' pid=216883 parent=216621 started daemon>}
2024-06-13 13:39:45 | INFO | controller | Process status: {}
2024-06-13 13:39:45 | INFO | controller | Process status: <Process name='controller (216763)' pid=216763 parent=216621 started daemon>
2024-06-13 13:39:45 | INFO | controller | Process status: <Process name='openai_api (216882)' pid=216882 parent=216621 started daemon>
2024-06-13 13:39:45 | INFO | controller | Process status: <Process name='API Server (217056)' pid=217056 parent=216621 stopped exitcode=1 daemon>
2024-06-13 13:39:45 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:39:45 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:39:45 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:39:45 | ERROR | stderr |     api_started.wait()
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:39:45 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:39:45 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:39:45 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:39:45 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:39:45 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:39:45 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:39:45 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:39:45 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:39:45 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:39:45 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:39:45 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:39:45 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:39:45 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f5412ce36a0>
2024-06-13 13:39:45 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:39:45 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:39:45 | ERROR | stderr |     finalizer()
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:39:45 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:39:45 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:39:45 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:39:45 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:39:45 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:39:45 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:39:45 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:39:45 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:39:45 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:39:45 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:39:45 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:39:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:39:45 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:39:45 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:39:48 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:39:48 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:39:50 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m217471[0m]
2024-06-13 13:39:50 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:39:50 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:39:50 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:39:51 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:39:51 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:39:51 | INFO | stdout | [32mINFO[0m:     192.168.110.131:48858 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:39:51 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m217543[0m]
2024-06-13 13:39:51 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:39:51 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:39:51 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:39:53 | ERROR | stderr | Process API Server:
2024-06-13 13:39:53 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
2024-06-13 13:39:53 | ERROR | stderr |     self.run()
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 108, in run
2024-06-13 13:39:53 | ERROR | stderr |     self._target(*self._args, **self._kwargs)
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 346, in run_api_server
2024-06-13 13:39:53 | ERROR | stderr |     app = create_app()
2024-06-13 13:39:53 | ERROR | stderr |           ^^^^^^^^^^^^
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 30, in create_app
2024-06-13 13:39:53 | ERROR | stderr |     mount_app_routes(app)
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 59, in mount_app_routes
2024-06-13 13:39:53 | ERROR | stderr |     mount_knowledge_routes(app)
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/api_router.py", line 39, in mount_knowledge_routes
2024-06-13 13:39:53 | ERROR | stderr |     from server.chat.knowledge_base_chat import knowledge_base_chat
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/chat/knowledge_base_chat.py", line 9, in <module>
2024-06-13 13:39:53 | ERROR | stderr |     from server.knowledge_base.kb_service.base import KBServiceFactory
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 24, in <module>
2024-06-13 13:39:53 | ERROR | stderr |     class KBService(ABC):
2024-06-13 13:39:53 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/server/knowledge_base/kb_service/base.py", line 267, in KBService
2024-06-13 13:39:53 | ERROR | stderr |     kb_file: KnowledgeFile):
2024-06-13 13:39:53 | ERROR | stderr |              ^^^^^^^^^^^^^
2024-06-13 13:39:53 | ERROR | stderr | NameError: name 'KnowledgeFile' is not defined
2024-06-13 13:40:36 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:40:36 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35092 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:40:43 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (217544)' pid=217544 parent=217266 started daemon>}
2024-06-13 13:40:43 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:40:43 | WARNING | controller | Sending SIGKILL to <Process name='controller (217471)' pid=217471 parent=217266 started daemon>
2024-06-13 13:40:43 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (217543)' pid=217543 parent=217266 started daemon>
2024-06-13 13:40:43 | WARNING | controller | Sending SIGKILL to <Process name='API Server (217733)' pid=217733 parent=217266 stopped exitcode=1 daemon>
2024-06-13 13:40:43 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (217544)' pid=217544 parent=217266 started daemon>}
2024-06-13 13:40:43 | INFO | controller | Process status: {}
2024-06-13 13:40:43 | INFO | controller | Process status: <Process name='controller (217471)' pid=217471 parent=217266 started daemon>
2024-06-13 13:40:43 | INFO | controller | Process status: <Process name='openai_api (217543)' pid=217543 parent=217266 started daemon>
2024-06-13 13:40:43 | INFO | controller | Process status: <Process name='API Server (217733)' pid=217733 parent=217266 stopped exitcode=1 daemon>
2024-06-13 13:40:43 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:40:43 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:40:43 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 489, in start_main_server
2024-06-13 13:40:43 | ERROR | stderr |     api_started.wait()
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 1097, in wait
2024-06-13 13:40:43 | ERROR | stderr |     return self._callmethod('wait', (timeout,))
2024-06-13 13:40:43 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:40:43 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:40:43 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:40:43 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:40:43 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:40:43 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:40:43 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:40:43 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:40:43 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:40:43 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:40:43 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:40:43 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7fc999b1b6a0>
2024-06-13 13:40:43 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:40:43 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:40:43 | ERROR | stderr |     finalizer()
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:40:43 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:40:43 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:40:43 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:40:43 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:40:43 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:40:43 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:40:43 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:40:43 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:40:43 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:40:43 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:40:43 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:40:43 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:40:43 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:40:43 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:40:46 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:40:46 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:40:48 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m218944[0m]
2024-06-13 13:40:48 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:40:48 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:40:48 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:40:49 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:40:49 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:40:49 | INFO | stdout | [32mINFO[0m:     192.168.110.131:55270 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:40:49 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m219022[0m]
2024-06-13 13:40:49 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:40:49 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:40:49 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:40:51 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m219194[0m]
2024-06-13 13:40:51 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:40:51 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:40:51 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:8000[0m (Press CTRL+C to quit)
2024-06-13 13:41:04 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59717 - "[1mPOST /api/chat/knowledge_base_chat HTTP/1.1[0m" [31m404 Not Found[0m
2024-06-13 13:41:34 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:41:34 | INFO | stdout | [32mINFO[0m:     192.168.110.131:34940 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:41:35 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59732 - "[1mGET /docs HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:41:36 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59732 - "[1mGET /openapi.json HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:10 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59740 - "[1mPOST /api/chat/knowledge_base_chat HTTP/1.1[0m" [31m404 Not Found[0m
2024-06-13 13:42:19 | INFO | controller | Receive heart beat. http://192.168.110.131:21001
2024-06-13 13:42:19 | INFO | stdout | [32mINFO[0m:     192.168.110.131:39694 - "[1mPOST /receive_heart_beat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:29 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59745 - "[1mPOST /api/chat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,666 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,667 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,669 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,669 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,670 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,671 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,673 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,699 INFO sqlalchemy.engine.Engine SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash
2024-06-13 13:42:29 | INFO | stdout | FROM user
2024-06-13 13:42:29 | INFO | stdout | WHERE user.id = %s
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,699 INFO sqlalchemy.engine.Engine [generated in 0.00084s] ('admin',)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,704 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,706 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,708 INFO sqlalchemy.engine.Engine SELECT conversation.id AS conversation_id, conversation.user_id AS conversation_user_id, conversation.name AS conversation_name, conversation.chat_type AS conversation_chat_type, conversation.create_time AS conversation_create_time
2024-06-13 13:42:29 | INFO | stdout | FROM conversation
2024-06-13 13:42:29 | INFO | stdout | WHERE conversation.id = %s
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,709 INFO sqlalchemy.engine.Engine [generated in 0.00082s] ('edcrfv33',)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,722 INFO sqlalchemy.engine.Engine INSERT INTO conversation (id, user_id, name, chat_type, create_time) VALUES (%s, %s, %s, %s, now())
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,722 INFO sqlalchemy.engine.Engine [generated in 0.00057s] ('edcrfv33', 'admin', 'Êñ∞Âª∫‰ºöËØù3', 'llm_chat')
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,726 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,736 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,739 INFO sqlalchemy.engine.Engine INSERT INTO message (id, conversation_id, chat_type, query, response, meta_data, feedback_score, feedback_reason, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, now())
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,740 INFO sqlalchemy.engine.Engine [generated in 0.00070s] ('b3dba09a309743c7873e87296ba23688', 'edcrfv33', 'llm_chat', '‰ªÄ‰πàÊòØÂø´‰πêÊòüÁêÉ', '', '{}', -1, '')
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,746 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:29 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 0.3.0. Use RunnableSequence, e.g., `prompt | llm` instead.
2024-06-13 13:42:29 | ERROR | stderr |   warn_deprecated(
2024-06-13 13:42:29 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The method `Chain.acall` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use ainvoke instead.
2024-06-13 13:42:29 | ERROR | stderr |   warn_deprecated(
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,989 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,992 INFO sqlalchemy.engine.Engine SELECT message.id, message.conversation_id, message.chat_type, message.query, message.response, message.meta_data, message.feedback_score, message.feedback_reason, message.create_time
2024-06-13 13:42:29 | INFO | stdout | FROM message
2024-06-13 13:42:29 | INFO | stdout | WHERE message.conversation_id = %s AND message.response != %s ORDER BY message.create_time DESC
2024-06-13 13:42:29 | INFO | stdout |  LIMIT %s
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,992 INFO sqlalchemy.engine.Engine [generated in 0.00047s] ('edcrfv33', '', 3)
2024-06-13 13:42:29 | INFO | stdout | 2024-06-13 13:42:29,994 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:30 | INFO | stdout | [32mINFO[0m:     192.168.110.131:59804 - "[1mPOST /list_models HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:30 | INFO | controller | names: ['http://192.168.110.131:21001'], queue_lens: [0.0], ret: http://192.168.110.131:21001
2024-06-13 13:42:30 | INFO | stdout | [32mINFO[0m:     192.168.110.131:59812 - "[1mPOST /get_worker_address HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:30 | INFO | stdout | [32mINFO[0m:     192.168.110.131:35608 - "[1mPOST /v1/chat/completions HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:40 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59751 - "[1mPOST /api/chat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,452 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,453 INFO sqlalchemy.engine.Engine SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash
2024-06-13 13:42:40 | INFO | stdout | FROM user
2024-06-13 13:42:40 | INFO | stdout | WHERE user.id = %s
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,453 INFO sqlalchemy.engine.Engine [cached since 10.75s ago] ('admin',)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,456 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,458 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,458 INFO sqlalchemy.engine.Engine SELECT conversation.id AS conversation_id, conversation.user_id AS conversation_user_id, conversation.name AS conversation_name, conversation.chat_type AS conversation_chat_type, conversation.create_time AS conversation_create_time
2024-06-13 13:42:40 | INFO | stdout | FROM conversation
2024-06-13 13:42:40 | INFO | stdout | WHERE conversation.id = %s
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,459 INFO sqlalchemy.engine.Engine [cached since 10.75s ago] ('edcrfv33',)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,461 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,463 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,464 INFO sqlalchemy.engine.Engine INSERT INTO message (id, conversation_id, chat_type, query, response, meta_data, feedback_score, feedback_reason, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, now())
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,465 INFO sqlalchemy.engine.Engine [cached since 10.73s ago] ('4305090db2204461a58e96dabfa299fd', 'edcrfv33', 'llm_chat', '‰ªÄ‰πàÊòØÂø´‰πêÊòüÁêÉ', '', '{}', -1, '')
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,467 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,607 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,608 INFO sqlalchemy.engine.Engine SELECT message.id, message.conversation_id, message.chat_type, message.query, message.response, message.meta_data, message.feedback_score, message.feedback_reason, message.create_time
2024-06-13 13:42:40 | INFO | stdout | FROM message
2024-06-13 13:42:40 | INFO | stdout | WHERE message.conversation_id = %s AND message.response != %s ORDER BY message.create_time DESC
2024-06-13 13:42:40 | INFO | stdout |  LIMIT %s
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,609 INFO sqlalchemy.engine.Engine [cached since 10.62s ago] ('edcrfv33', '', 3)
2024-06-13 13:42:40 | INFO | stdout | 2024-06-13 13:42:40,611 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:40 | INFO | stdout | [32mINFO[0m:     192.168.110.131:49496 - "[1mPOST /list_models HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:40 | INFO | controller | names: ['http://192.168.110.131:21001'], queue_lens: [1.0], ret: http://192.168.110.131:21001
2024-06-13 13:42:40 | INFO | stdout | [32mINFO[0m:     192.168.110.131:49510 - "[1mPOST /get_worker_address HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:40 | INFO | stdout | [32mINFO[0m:     192.168.110.131:58654 - "[1mPOST /v1/chat/completions HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:42 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59751 - "[1mPOST /api/chat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,717 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,718 INFO sqlalchemy.engine.Engine SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash
2024-06-13 13:42:42 | INFO | stdout | FROM user
2024-06-13 13:42:42 | INFO | stdout | WHERE user.id = %s
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,719 INFO sqlalchemy.engine.Engine [cached since 13.02s ago] ('admin',)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,721 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,723 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,724 INFO sqlalchemy.engine.Engine SELECT conversation.id AS conversation_id, conversation.user_id AS conversation_user_id, conversation.name AS conversation_name, conversation.chat_type AS conversation_chat_type, conversation.create_time AS conversation_create_time
2024-06-13 13:42:42 | INFO | stdout | FROM conversation
2024-06-13 13:42:42 | INFO | stdout | WHERE conversation.id = %s
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,724 INFO sqlalchemy.engine.Engine [cached since 13.02s ago] ('edcrfv33',)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,726 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,729 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,730 INFO sqlalchemy.engine.Engine INSERT INTO message (id, conversation_id, chat_type, query, response, meta_data, feedback_score, feedback_reason, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, now())
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,730 INFO sqlalchemy.engine.Engine [cached since 12.99s ago] ('e209c318746f4fd4b8f80981f3c5cb81', 'edcrfv33', 'llm_chat', '‰ªÄ‰πàÊòØÂø´‰πêÊòüÁêÉ', '', '{}', -1, '')
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,732 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,863 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,864 INFO sqlalchemy.engine.Engine SELECT message.id, message.conversation_id, message.chat_type, message.query, message.response, message.meta_data, message.feedback_score, message.feedback_reason, message.create_time
2024-06-13 13:42:42 | INFO | stdout | FROM message
2024-06-13 13:42:42 | INFO | stdout | WHERE message.conversation_id = %s AND message.response != %s ORDER BY message.create_time DESC
2024-06-13 13:42:42 | INFO | stdout |  LIMIT %s
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,864 INFO sqlalchemy.engine.Engine [cached since 12.87s ago] ('edcrfv33', '', 3)
2024-06-13 13:42:42 | INFO | stdout | 2024-06-13 13:42:42,865 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:42 | INFO | stdout | [32mINFO[0m:     192.168.110.131:45374 - "[1mPOST /list_models HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:42 | INFO | controller | names: ['http://192.168.110.131:21001'], queue_lens: [2.0], ret: http://192.168.110.131:21001
2024-06-13 13:42:42 | INFO | stdout | [32mINFO[0m:     192.168.110.131:45376 - "[1mPOST /get_worker_address HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:42 | INFO | stdout | [32mINFO[0m:     192.168.110.131:55572 - "[1mPOST /v1/chat/completions HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:43 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59751 - "[1mPOST /api/chat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,830 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,831 INFO sqlalchemy.engine.Engine SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash
2024-06-13 13:42:43 | INFO | stdout | FROM user
2024-06-13 13:42:43 | INFO | stdout | WHERE user.id = %s
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,831 INFO sqlalchemy.engine.Engine [cached since 14.13s ago] ('admin',)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,832 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,834 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,834 INFO sqlalchemy.engine.Engine SELECT conversation.id AS conversation_id, conversation.user_id AS conversation_user_id, conversation.name AS conversation_name, conversation.chat_type AS conversation_chat_type, conversation.create_time AS conversation_create_time
2024-06-13 13:42:43 | INFO | stdout | FROM conversation
2024-06-13 13:42:43 | INFO | stdout | WHERE conversation.id = %s
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,834 INFO sqlalchemy.engine.Engine [cached since 14.13s ago] ('edcrfv33',)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,836 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,837 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,837 INFO sqlalchemy.engine.Engine INSERT INTO message (id, conversation_id, chat_type, query, response, meta_data, feedback_score, feedback_reason, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, now())
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,838 INFO sqlalchemy.engine.Engine [cached since 14.1s ago] ('41dd38f1267c464aad60c0c5148bda60', 'edcrfv33', 'llm_chat', '‰ªÄ‰πàÊòØÂø´‰πêÊòüÁêÉ', '', '{}', -1, '')
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,839 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,939 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,939 INFO sqlalchemy.engine.Engine SELECT message.id, message.conversation_id, message.chat_type, message.query, message.response, message.meta_data, message.feedback_score, message.feedback_reason, message.create_time
2024-06-13 13:42:43 | INFO | stdout | FROM message
2024-06-13 13:42:43 | INFO | stdout | WHERE message.conversation_id = %s AND message.response != %s ORDER BY message.create_time DESC
2024-06-13 13:42:43 | INFO | stdout |  LIMIT %s
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,940 INFO sqlalchemy.engine.Engine [cached since 13.95s ago] ('edcrfv33', '', 3)
2024-06-13 13:42:43 | INFO | stdout | 2024-06-13 13:42:43,941 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:43 | INFO | stdout | [32mINFO[0m:     192.168.110.131:45382 - "[1mPOST /list_models HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:43 | INFO | controller | names: ['http://192.168.110.131:21001'], queue_lens: [3.0], ret: http://192.168.110.131:21001
2024-06-13 13:42:43 | INFO | stdout | [32mINFO[0m:     192.168.110.131:45392 - "[1mPOST /get_worker_address HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:43 | INFO | stdout | [32mINFO[0m:     192.168.110.131:55582 - "[1mPOST /v1/chat/completions HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:45 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (219023)' pid=219023 parent=218762 started daemon>}
2024-06-13 13:42:45 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:42:45 | WARNING | controller | Sending SIGKILL to <Process name='controller (218944)' pid=218944 parent=218762 started daemon>
2024-06-13 13:42:45 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (219022)' pid=219022 parent=218762 started daemon>
2024-06-13 13:42:45 | WARNING | controller | Sending SIGKILL to <Process name='API Server (219194)' pid=219194 parent=218762 started daemon>
2024-06-13 13:42:45 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (219023)' pid=219023 parent=218762 started daemon>}
2024-06-13 13:42:45 | INFO | controller | Process status: {}
2024-06-13 13:42:45 | INFO | controller | Process status: <Process name='controller (218944)' pid=218944 parent=218762 started daemon>
2024-06-13 13:42:45 | INFO | controller | Process status: <Process name='openai_api (219022)' pid=219022 parent=218762 started daemon>
2024-06-13 13:42:45 | INFO | controller | Process status: <Process name='API Server (219194)' pid=219194 parent=218762 started daemon>
2024-06-13 13:42:45 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:42:45 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:42:45 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 492, in start_main_server
2024-06-13 13:42:45 | ERROR | stderr |     cmd = queue.get()
2024-06-13 13:42:45 | ERROR | stderr |           ^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "<string>", line 2, in get
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:42:45 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:42:45 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:42:45 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:42:45 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:42:45 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:42:45 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:42:45 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:42:45 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:45 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:42:45 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:42:45 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:42:46 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f61816cb6a0>
2024-06-13 13:42:46 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:42:46 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:42:46 | ERROR | stderr |     finalizer()
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:42:46 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:42:46 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:42:46 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:42:46 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:42:46 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:42:46 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:42:46 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:42:46 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:42:46 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:42:46 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:42:46 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:42:46 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:42:46 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:42:46 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:42:50 | INFO | controller | Ê≠£Âú®ÂêØÂä®ÊúçÂä°Ôºö
2024-06-13 13:42:50 | INFO | controller | Â¶ÇÈúÄÊü•Áúã ÊúçÂä°Êó•Âøó Êó•ÂøóÔºåËØ∑ÂâçÂæÄ /home/00_rag/fufan-chat-api/logs
2024-06-13 13:42:51 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m220971[0m]
2024-06-13 13:42:51 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:42:51 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:42:51 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20001[0m (Press CTRL+C to quit)
2024-06-13 13:42:53 | INFO | controller | Register a new worker: http://192.168.110.131:21001
2024-06-13 13:42:53 | INFO | controller | Register done: http://192.168.110.131:21001, {'model_names': ['zhipu-api'], 'speed': 1, 'queue_length': 0}
2024-06-13 13:42:53 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42828 - "[1mPOST /register_worker HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:53 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m221043[0m]
2024-06-13 13:42:53 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:42:53 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:42:53 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:20000[0m (Press CTRL+C to quit)
2024-06-13 13:42:54 | ERROR | stderr | [32mINFO[0m:     Started server process [[36m221184[0m]
2024-06-13 13:42:54 | ERROR | stderr | [32mINFO[0m:     Waiting for application startup.
2024-06-13 13:42:54 | ERROR | stderr | [32mINFO[0m:     Application startup complete.
2024-06-13 13:42:54 | ERROR | stderr | [32mINFO[0m:     Uvicorn running on [1mhttp://192.168.110.131:8000[0m (Press CTRL+C to quit)
2024-06-13 13:42:58 | INFO | stdout | [32mINFO[0m:     192.168.110.91:59760 - "[1mPOST /api/chat HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,787 INFO sqlalchemy.engine.Engine SELECT DATABASE()
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,787 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,789 INFO sqlalchemy.engine.Engine SELECT @@sql_mode
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,790 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,791 INFO sqlalchemy.engine.Engine SELECT @@lower_case_table_names
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,791 INFO sqlalchemy.engine.Engine [raw sql] ()
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,793 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,819 INFO sqlalchemy.engine.Engine SELECT user.id AS user_id, user.username AS user_username, user.password_hash AS user_password_hash
2024-06-13 13:42:58 | INFO | stdout | FROM user
2024-06-13 13:42:58 | INFO | stdout | WHERE user.id = %s
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,819 INFO sqlalchemy.engine.Engine [generated in 0.00090s] ('admin',)
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,822 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,824 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,827 INFO sqlalchemy.engine.Engine SELECT conversation.id AS conversation_id, conversation.user_id AS conversation_user_id, conversation.name AS conversation_name, conversation.chat_type AS conversation_chat_type, conversation.create_time AS conversation_create_time
2024-06-13 13:42:58 | INFO | stdout | FROM conversation
2024-06-13 13:42:58 | INFO | stdout | WHERE conversation.id = %s
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,827 INFO sqlalchemy.engine.Engine [generated in 0.00079s] ('edcrfv33',)
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,829 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,831 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,835 INFO sqlalchemy.engine.Engine INSERT INTO message (id, conversation_id, chat_type, query, response, meta_data, feedback_score, feedback_reason, create_time) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, now())
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,835 INFO sqlalchemy.engine.Engine [generated in 0.00071s] ('5eb913c2382d4e70b750c95230bdfab6', 'edcrfv33', 'llm_chat', '‰ªÄ‰πàÊòØÂø´‰πêÊòüÁêÉ', '', '{}', -1, '')
2024-06-13 13:42:58 | INFO | stdout | 2024-06-13 13:42:58,838 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:59 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The class `LLMChain` was deprecated in LangChain 0.1.17 and will be removed in 0.3.0. Use RunnableSequence, e.g., `prompt | llm` instead.
2024-06-13 13:42:59 | ERROR | stderr |   warn_deprecated(
2024-06-13 13:42:59 | ERROR | stderr | /home/util/anaconda3/envs/fufan-chat/lib/python3.11/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The method `Chain.acall` was deprecated in langchain 0.1.0 and will be removed in 0.3.0. Use ainvoke instead.
2024-06-13 13:42:59 | ERROR | stderr |   warn_deprecated(
2024-06-13 13:42:59 | INFO | stdout | 2024-06-13 13:42:59,067 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2024-06-13 13:42:59 | INFO | stdout | 2024-06-13 13:42:59,068 INFO sqlalchemy.engine.Engine SELECT message.id, message.conversation_id, message.chat_type, message.query, message.response, message.meta_data, message.feedback_score, message.feedback_reason, message.create_time
2024-06-13 13:42:59 | INFO | stdout | FROM message
2024-06-13 13:42:59 | INFO | stdout | WHERE message.conversation_id = %s AND message.response != %s ORDER BY message.create_time DESC
2024-06-13 13:42:59 | INFO | stdout |  LIMIT %s
2024-06-13 13:42:59 | INFO | stdout | 2024-06-13 13:42:59,069 INFO sqlalchemy.engine.Engine [generated in 0.00046s] ('edcrfv33', '', 3)
2024-06-13 13:42:59 | INFO | stdout | 2024-06-13 13:42:59,071 INFO sqlalchemy.engine.Engine COMMIT
2024-06-13 13:42:59 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42834 - "[1mPOST /list_models HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:59 | INFO | controller | names: ['http://192.168.110.131:21001'], queue_lens: [0.0], ret: http://192.168.110.131:21001
2024-06-13 13:42:59 | INFO | stdout | [32mINFO[0m:     192.168.110.131:42842 - "[1mPOST /get_worker_address HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:42:59 | INFO | stdout | [32mINFO[0m:     192.168.110.131:49288 - "[1mPOST /v1/chat/completions HTTP/1.1[0m" [32m200 OK[0m
2024-06-13 13:43:07 | WARNING | controller | Sending SIGKILL to {'zhipu-api': <Process name='api_worker - zhipu-api (221044)' pid=221044 parent=220775 started daemon>}
2024-06-13 13:43:07 | WARNING | controller | Sending SIGKILL to {}
2024-06-13 13:43:07 | WARNING | controller | Sending SIGKILL to <Process name='controller (220971)' pid=220971 parent=220775 started daemon>
2024-06-13 13:43:07 | WARNING | controller | Sending SIGKILL to <Process name='openai_api (221043)' pid=221043 parent=220775 started daemon>
2024-06-13 13:43:07 | WARNING | controller | Sending SIGKILL to <Process name='API Server (221184)' pid=221184 parent=220775 started daemon>
2024-06-13 13:43:07 | INFO | controller | Process status: {'zhipu-api': <Process name='api_worker - zhipu-api (221044)' pid=221044 parent=220775 started daemon>}
2024-06-13 13:43:07 | INFO | controller | Process status: {}
2024-06-13 13:43:07 | INFO | controller | Process status: <Process name='controller (220971)' pid=220971 parent=220775 started daemon>
2024-06-13 13:43:07 | INFO | controller | Process status: <Process name='openai_api (221043)' pid=221043 parent=220775 started daemon>
2024-06-13 13:43:07 | INFO | controller | Process status: <Process name='API Server (221184)' pid=221184 parent=220775 started daemon>
2024-06-13 13:43:07 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 580, in <module>
2024-06-13 13:43:07 | ERROR | stderr |     loop.run_until_complete(start_main_server())
2024-06-13 13:43:07 | ERROR | stderr |                             ^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 492, in start_main_server
2024-06-13 13:43:07 | ERROR | stderr |     cmd = queue.get()
2024-06-13 13:43:07 | ERROR | stderr |           ^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "<string>", line 2, in get
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 822, in _callmethod
2024-06-13 13:43:07 | ERROR | stderr |     kind, result = conn.recv()
2024-06-13 13:43:07 | ERROR | stderr |                    ^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 250, in recv
2024-06-13 13:43:07 | ERROR | stderr |     buf = self._recv_bytes()
2024-06-13 13:43:07 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
2024-06-13 13:43:07 | ERROR | stderr |     buf = self._recv(4)
2024-06-13 13:43:07 | ERROR | stderr |           ^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 395, in _recv
2024-06-13 13:43:07 | ERROR | stderr |     chunk = read(handle, remaining)
2024-06-13 13:43:07 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:43:07 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:43:07 | ERROR | stderr | KeyboardInterrupt: SIGINT received
2024-06-13 13:43:07 | ERROR | stderr | Exception ignored in atexit callback: <function _exit_function at 0x7f422a5af6a0>
2024-06-13 13:43:07 | ERROR | stderr | Traceback (most recent call last):
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 334, in _exit_function
2024-06-13 13:43:07 | ERROR | stderr |     _run_finalizers(0)
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 300, in _run_finalizers
2024-06-13 13:43:07 | ERROR | stderr |     finalizer()
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/util.py", line 224, in __call__
2024-06-13 13:43:07 | ERROR | stderr |     res = self._callback(*self._args, **self._kwargs)
2024-06-13 13:43:07 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/managers.py", line 676, in _finalize_manager
2024-06-13 13:43:07 | ERROR | stderr |     process.join(timeout=shutdown_timeout)
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/process.py", line 149, in join
2024-06-13 13:43:07 | ERROR | stderr |     res = self._popen.wait(timeout)
2024-06-13 13:43:07 | ERROR | stderr |           ^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
2024-06-13 13:43:07 | ERROR | stderr |     if not wait([self.sentinel], timeout):
2024-06-13 13:43:07 | ERROR | stderr |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/multiprocessing/connection.py", line 947, in wait
2024-06-13 13:43:07 | ERROR | stderr |     ready = selector.select(timeout)
2024-06-13 13:43:07 | ERROR | stderr |             ^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/util/anaconda3/envs/fufan-chat/lib/python3.11/selectors.py", line 415, in select
2024-06-13 13:43:07 | ERROR | stderr |     fd_event_list = self._selector.poll(timeout)
2024-06-13 13:43:07 | ERROR | stderr |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-06-13 13:43:07 | ERROR | stderr |   File "/home/00_rag/fufan-chat-api/startup.py", line 368, in f
2024-06-13 13:43:07 | ERROR | stderr |     raise KeyboardInterrupt(f"{signalname} received")
2024-06-13 13:43:07 | ERROR | stderr | KeyboardInterrupt: SIGINT received
