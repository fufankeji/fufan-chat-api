import{M as k,s as q,_ as H,Q as I}from"./index.vue_vue_type_script_setup_true_lang-CSuimxwc.js";import{a as U,u as z,c as D}from"./chatHistory-D8um-KwZ.js";import{d as C,ai as f,o as s,c as p,a as r,V as t,P as l,T as h,U as S,u as m,J as E,F as V,a8 as M,Q as P,W as Q,r as w,h as Y,O as B,n as A,R as F}from"./vue-39WfQX0x.js";import{e as T,_ as g}from"./index-Dzv453Ar.js";import"./element-jUUjv72Y.js";import"./vxe-DW97H3iJ.js";var $=(o=>(o.SYSTEM="SYSTEM",o.USER="USER",o))($||{});const O={class:E({"chat-record":!0,"chat-question":!0})},J={class:"chat-content"},L={class:E({"chat-record":!0,"chat-question":!1})},W=C({__name:"ChatRecord",props:{data:{}},setup(o){const e=T(),a=o;return(v,n)=>{const i=f("el-avatar"),_=f("el-text");return s(),p(V,null,[r("div",O,[t(i,{size:24,src:m(e).photo},{default:l(()=>{var c;return[h(S((c=m(e).username)==null?void 0:c[0]),1)]}),_:1},8,["src"]),r("div",J,[t(_,{type:"info",class:"time"},{default:l(()=>[h(S(a.data.create_time),1)]),_:1}),t(k,{moduleValue:a.data.query},null,8,["moduleValue"])])]),r("div",L,[t(i,{size:24,src:m(q)},{default:l(()=>[h(S(m($).SYSTEM),1)]),_:1},8,["src"]),r("div",{class:E({"chat-content":!0,"chat-error":!a.data.response})},[t(_,{type:"info",class:"time"},{default:l(()=>[h(S(a.data.create_time),1)]),_:1}),(s(!0),p(V,null,M(a.data.search,(c,y)=>P((s(),p("div",{class:"ai-search-content",key:y},[t(k,{moduleValue:c},null,8,["moduleValue"])])),[[Q,!!a.data.search]])),128)),t(k,{moduleValue:a.data.response},null,8,["moduleValue"])],2)])],64)}}}),j=g(W,[["__scopeId","data-v-b6790afa"]]),G={class:"main-center"},K={class:"chat-input-top"},X=C({__name:"ChatRecords",setup(o){const e=U(),a=T(),v=z(),n=w(null),i=w("");function _(){A(()=>{n.value&&(n.value.scrollTop=n.value.scrollHeight)})}async function c(d){const u=d||"新对话",R=e.chat_type,x=await D({user_id:a.token,name:u,chat_type:R});e.onSelectConversation(x.id),!d&&e.getChatHistory()}async function y(d){const u=d.trim();u&&(!e.conversation_id&&await c(u),v.getConversations(),e.chatAISearch({query:u}))}async function N(){await c(),v.getConversations()}return Y(()=>{_(),e.setOnScrollBottom(_)}),(d,u)=>{const R=f("el-button");return s(),p("div",G,[r("div",{class:"chat-records",ref_key:"chatRecordsRef",ref:n},[(s(!0),p(V,null,M(m(e).chat_history,(x,b)=>(s(),B(j,{key:b,data:x},null,8,["data"]))),128))],512),r("div",null,[r("div",K,[t(R,{class:"new-chat",onClick:N},{default:l(()=>[h("新建对话")]),_:1}),t(H)]),t(I,{class:"quill-editor",ploherholder:"Enter发送；Shift+Enter换行",value:i.value,onEnter:y},null,8,["value"])])])}}}),Z=g(X,[["__scopeId","data-v-1b28ce07"]]),ee=C({__name:"Chat",setup(o){const e=w();return(a,v)=>{const n=f("el-main"),i=f("el-container");return s(),B(i,null,{default:l(()=>[t(n,{class:"layout-main"},{default:l(()=>[t(Z,{ref_key:"chatRecordsRef",ref:e},null,512)]),_:1})]),_:1})}}}),te=g(ee,[["__scopeId","data-v-c46621dd"]]),le=C({__name:"index",setup(o){return(e,a)=>(s(),B(F(te)))}});export{le as default};
