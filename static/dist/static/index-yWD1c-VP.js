import{M as E,s as q,_ as H,Q as U}from"./index.vue_vue_type_script_setup_true_lang-CSuimxwc.js";import{a as z,u as I,c as P}from"./chatHistory-D8um-KwZ.js";import{e as g,_ as k}from"./index-Dzv453Ar.js";import{d as C,ai as h,o as i,c as R,a as n,V as e,P as c,T as m,U as v,u as p,J as V,F as B,r as x,h as Y,a8 as b,O as w,n as D,R as F}from"./vue-39WfQX0x.js";import"./element-jUUjv72Y.js";import"./vxe-DW97H3iJ.js";var M=(o=>(o.SYSTEM="SYSTEM",o.USER="USER",o))(M||{});const O={class:V({"chat-record":!0,"chat-question":!0})},Q={class:"chat-content"},A={class:V({"chat-record":!0,"chat-question":!1})},J=C({__name:"ChatRecord",props:{data:{}},setup(o){const t=g(),a=o;return(f,s)=>{const r=h("el-avatar"),_=h("el-text");return i(),R(B,null,[n("div",O,[e(r,{size:24,src:p(t).photo},{default:c(()=>{var u;return[m(v((u=p(t).username)==null?void 0:u[0]),1)]}),_:1},8,["src"]),n("div",Q,[e(_,{type:"info",class:"time"},{default:c(()=>[m(v(a.data.create_time),1)]),_:1}),e(E,{moduleValue:a.data.query},null,8,["moduleValue"])])]),n("div",A,[e(r,{size:24,src:p(q)},{default:c(()=>[m(v(p(M).SYSTEM),1)]),_:1},8,["src"]),n("div",{class:V({"chat-content":!0,"chat-error":!a.data.response})},[e(_,{type:"info",class:"time"},{default:c(()=>[m(v(a.data.create_time),1)]),_:1}),e(E,{moduleValue:a.data.response},null,8,["moduleValue"])],2)])],64)}}}),L=k(J,[["__scopeId","data-v-1f80d291"]]),j={class:"main-center"},G={class:"chat-input-top"},K=C({__name:"ChatRecords",setup(o){const t=z(),a=g(),f=I(),s=x(null),r=x("");function _(){D(()=>{s.value&&(s.value.scrollTop=s.value.scrollHeight)})}async function u(d){const l=d||"新对话",S=t.chat_type,y=await P({user_id:a.token,name:l,chat_type:S});t.onSelectConversation(y.id),!d&&t.getChatHistory()}async function T(d){const l=d.trim();l&&(!t.conversation_id&&await u(l),f.getConversations(),t.chat({query:l}))}async function $(){await u(),f.getConversations()}return Y(()=>{_(),t.setOnScrollBottom(_)}),(d,l)=>{const S=h("el-button");return i(),R("div",j,[n("div",{class:"chat-records",ref_key:"chatRecordsRef",ref:s},[(i(!0),R(B,null,b(p(t).chat_history,(y,N)=>(i(),w(L,{key:N,data:y},null,8,["data"]))),128))],512),n("div",null,[n("div",G,[e(S,{class:"new-chat",onClick:$},{default:c(()=>[m("新建对话")]),_:1}),e(H)]),e(U,{class:"quill-editor",value:r.value,onEnter:T},null,8,["value"])])])}}}),W=k(K,[["__scopeId","data-v-4cfeea61"]]),X=C({__name:"Chat",setup(o){const t=x();return(a,f)=>{const s=h("el-main"),r=h("el-container");return i(),w(r,null,{default:c(()=>[e(s,{class:"layout-main"},{default:c(()=>[e(W,{ref_key:"chatRecordsRef",ref:t},null,512)]),_:1})]),_:1})}}}),Z=k(X,[["__scopeId","data-v-303c5327"]]),ct=C({__name:"index",setup(o){return(t,a)=>(i(),w(F(Z)))}});export{ct as default};
